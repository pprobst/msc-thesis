% -*- mode: latex; coding: utf-8 -*-
\input{blocksworld.tex}

%\documentclass{gkibeamer}
\documentclass{beamer}

\usepackage{tikz}
\usepackage{ifthen}
\usepackage{stmaryrd}
\usepackage[T1]{fontenc}
\usepackage[brazil]{babel}
\usepackage[utf8]{inputenc}
\usetheme{Inf}

\setbeamertemplate{footline}[frame number]

\title[Discovering and Learning Preferred Operators]{Discovering and Learning Preferred Operators for Classical Planning with Neural Networks}
\author{Pedro Probst Minini}

\institute{Federal University of Rio Grande do Sul\\Institute of Informatics\\Department of Theoretical Informatics}
\subject{AI}

\input{macros}

% #############################################################################################################
%
%% Needed for "Content of this Course" slide in most chapters:
\usetikzlibrary{positioning, arrows.meta, patterns, automata}

\usepackage[linesnumbered, ruled, vlined]{algorithm2e}
\usepackage{mathtools}
\usepackage{booktabs}
\usepackage{comment}
%\usepackage{natbib}
\usepackage[citestyle=authoryear,maxnames=10,maxcitenames=1,giveninits=true,backend=biber,uniquelist=false]{biblatex}
\usepackage[utf8]{inputenc}
\usepackage[textsize=tiny,colorinlistoftodos,prependcaption]{todonotes}
\addbibresource{biblio.bib}

\newcommand{\pp}[2][noinline]{\todo[color=purple!50,linecolor={purple!100},#1,fancyline,author=Pedro]{#2}}
\newcommand{\ppi}[2][inline]{\todo[color=purple!50,linecolor={purple!100},#1,fancyline,author=Pedro]{#2}}

% #####################
\AtBeginSubsection[]
{
\begin{frame}[noframenumbering]
    \frametitle{\n}
    \tableofcontents[currentsection,currentsubsection]
\end{frame}
}
% #####################

% #############################################################################################################

%\subtitle{Some title}
%\date{}
%\begin{document}

%\begin{frame}{Outline}
%\tableofcontents
%\end{frame}

% Define the title with \title[short title]{long title}
% Short title is optional
\title[Discovering and Learning Preferred Operators]
      {Discovering and Learning Preferred Operators for Classical Planning with Neural Networks}

% Optional subtitle
%\subtitle{Defesa de Mestrado}

\date{Julho de 2023}

% Author information
\author{Pedro Probst Minini}
\institute{Instituto de Informática --- UFRGS\\\texttt{inf.ufrgs.br/\~{}bmenegola}}

\begin{document}

% Command to create title page
\InfTitlePage

\begin{frame}{Outline}
  \frametitle{Agenda}
  \tableofcontents
\end{frame}

\section{Introdução}
\subsection{Planejamento}
\begin{frame}{Planejamento Clássico}
\emph{Planejamento} tem o objetivo de encontrar uma \alert{sequência de ações} a partir de um \alert{estado inicial} que satisfaça as \alert{condições objetivo}.
    \begin{exampleblock}{\strut Exemplo: Planejamento Clássico}
      \hilite{ambiente}
      \begin{itemize}
      \item \alert{estático} vs.\ \grey{dinâmico}
        \pause
      \item \alert{determinístico} vs.\ \grey{não determinístico}
        vs.\ \grey{estocástico}
        \pause
      \item \alert{observável}
        vs.\ \grey{parcialmente observável}
        vs.\ \grey{não observável}
        \pause
      \item \alert{discreto} vs.\ \grey{contínuo}
        \pause
      \item \alert{agente único} vs.\ \grey{agentes multiplos}
      \end{itemize}

      \pause
      \hilite{método de resolução}
      \begin{itemize}
      \item \grey{específico por problema} vs.\ \alert{geral} vs.\ \orange{aprendizado}
      \end{itemize}
    \end{exampleblock}
% ppi{Then briefly talk about non-deterministic planning.}
% Classical Planning is an example of a "model".
\end{frame}

\begin{frame}{STRIPS}
  \begin{definition}[Um problema de planejamento em STRIPS]
    $\Pi = \langle F, O, s_{0}, s^{*}\rangle$ onde
    \begin{itemize}
        \item $F$ é um conjunto de variáveis booleanas (\alert{fatos ou proposições}),
        \item $O$ é um conjunto de \alert{operadores} ou ações sobre $F$, onde $\langle pre(o), add(o), del(o) \rangle \subseteq F$,
        \item $s_{0} \subseteq F$ é o conjunto de fatos que representa o \alert{estado inicial}, e
        \item $s^{*} \subseteq F$ é o conjunto de fatos que devem ser satisfeitos (``\alert{gol}'').
    \end{itemize}
   \pause
    As ações $A(s)$ são \alert{aplicáveis} em $s$ se elas satisfizerem $pre(o)$.

    Avançamos de um estado $s$ com o operador $o$ definindo as proposições em $add(o)$ como \alert{verdadeiras} e em $del(o)$ como \alert{falsas}.
    \pause

    Por fim, $\pi = o_{1}, o_{2},\ldots, o_{n}$ é chamado de \alert{plano} para $\Pi$, em que $o_{i}$ é um operador aplicável.
\end{definition}
%Planning tasks are usually formally described in PDDL files, following a Lisp-like structure.
\end{frame}

\begin{frame}{Example: Blocksworld} 
\begin{figure}
    \centering
    \includegraphics[width=7cm]{img/blocksworld1.png}
    \caption{Uma tarefa de planejamento do domínio Blocks World.}
\end{figure}
\end{frame}

\begin{frame}{Exemplo: Blocksworld}
% This is from Malte Helmert's slides, slightly modified.
    \begin{exampleblock}{\strut Exemplo: Blocks World}
      \hilite{$\Pi = \langle F, O, s_{0}, s^{*}\rangle$}
      \begin{itemize}
      \item $F$ = \{on(a,b), on(a,c), on(b,a), on(b,c), on(c,a), on(c,b), on-table(a), on-table(b), on-table(c), clear(a), clear(b), clear(c)\}

       \item $O$ = \{move(a,b,c), move(a,c,b), move(b,a,c), move(b,c,a), move(c,a,b), move(c,b,a), to-table(a,b), to-table(a,c), to-table(b,a), to-table(b,c), to-table(c,a), to-table(c,b), from-table(a,b), from-table(a,c), from-table(b,a), from-table(b,c), from-table(c,a), from-table(c,b)\}

        \item $s_{0}$ = \{on(c,a), on-table(a), on-table(b), clear(c), clear(b)\}

         \item $s^{*}$ = \{on(a,b), on(b,c)\}
      \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Exemplo: Blocks World}
    \begin{exampleblock}{\strut Exemmplo: Blocks World}
      \begin{itemize}
      \item \emph{move}: move a block from one block to another.
      \begin{itemize}
        \item Pre(move(a,b,c)) = \{on(a,b), clear(a), clear(c)\}
        \item Add(move(a,b,c)) = \{on(a,c), clear(b)\}
        \item Del(move(a,b,c)) = \{on(a,b), clear(c)\}
        \item Com base no estado inicial, essa ação é aplicável? % Não, ela não satisfaz as condições prévias.
      \end{itemize}
      \item \emph{to-table}: mover um bloco de um bloco para a mesa.
      \item \emph{from-table}: mover um bloco de um bloco para a mesa.
      \end{itemize}
    \end{exampleblock}
\end{frame}

\begin{frame}{Espaço de estados do Blocks World com 3 blocos}
  \begin{center}
    \begin{pgfpicture}{-39mm}{-32.4mm}{39mm}{32.4mm}
      \pgfnodebox{RsGsB}[virtual]{\pgfpolar{0}{0cm}}{\RsGsB}{2pt}{2pt}

      \pgfnodebox{RGsB}[virtual]{\pgfpolar{0}{16mm}}{\RGsB}{2pt}{2pt}
      \pgfnodebox{RBsG}[virtual]{\pgfpolar{60}{16mm}}{\RBsG}{2pt}{2pt}
      \pgfnodebox{BRsG}[virtual]{\pgfpolar{120}{16mm}}{\BRsG}{2pt}{2pt}
      \pgfnodebox{RsBG}[virtual]{\pgfpolar{180}{16mm}}{\RsBG}{2pt}{2pt}
      \pgfnodebox{RsGB}[virtual]{\pgfpolar{240}{16mm}}{\RsGB}{2pt}{2pt}
      \pgfnodebox{GRsB}[virtual]{\pgfpolar{300}{16mm}}{\GRsB}{2pt}{2pt}

      \pgfnodebox{BRG}[virtual]{\pgfpolar{0}{32mm}}{\BRG}{2pt}{2pt}
      \pgfnodebox{GRB}[virtual]{\pgfpolar{50}{32mm}}{\GRB}{2pt}{2pt}
      \pgfnodebox{GBR}[virtual]{\pgfpolar{130}{32mm}}{\GBR}{2pt}{2pt}
      \pgfnodebox{RBG}[virtual]{\pgfpolar{180}{32mm}}{\RBG}{2pt}{2pt}
      \pgfnodebox{RGB}[virtual]{\pgfpolar{230}{32mm}}{\RGB}{2pt}{2pt}
      \pgfnodebox{BGR}[virtual]{\pgfpolar{310}{32mm}}{\BGR}{2pt}{2pt}

      \pgfsetendarrow{\pgfarrowtriangle{5pt}}
      \pgfsetstartarrow{\pgfarrowtriangle{5pt}}

      \pgfnodeconnline{RsGsB}{RGsB}
      \pgfnodeconnline{RsGsB}{RBsG}
      \pgfnodeconnline{RsGsB}{BRsG}
      \pgfnodeconnline{RsGsB}{RsBG}
      \pgfnodeconnline{RsGsB}{RsGB}
      \pgfnodeconnline{RsGsB}{GRsB}

      \pgfnodeconnline{RGsB}{BRG}
      \pgfnodeconnline{RBsG}{GRB}
      \pgfnodeconnline{BRsG}{GBR}
      \pgfnodeconnline{RsBG}{RBG}
      \pgfnodeconnline{RsGB}{RGB}
      \pgfnodeconnline{GRsB}{BGR}

      \pgfnodeconnline{RGsB}{RBsG}
      \pgfnodeconnline{BRsG}{RsBG}
      \pgfnodeconnline{RsGB}{GRsB}
    \end{pgfpicture}
  \end{center}
\end{frame}

\begin{frame}{\sas}
\begin{itemize}
\item \sas é similar a STRIPS, mas variáveis têm domínios finitos, não sendo necessariamente binárias.
  \item O estado inicial $s^{*}$ é tipicamente um \alert{estado completo}, i.e., todas as variáveis estão definidas.
  \item O gol $s^{*}$ é definido \alert{parcialmente}, com certas variáveis indefinidas ($\bot$).
\end{itemize}
\end{frame}

\subsection{Busca Heurística}
\begin{frame}{Busca heurística}
\begin{itemize}
  \item Planejadores tipicamente buscam satisfazer o gol \alert{priorizando} estados no espaço de estados com \alert{menor função heurística}.
  \pause
  \item Um estado $s$ tem uma função heurística $h(s)$, dado por uma função heurística $h$, que estima o \alert{custo de atingir o gol $s^{*}$} a partir de $s$.
  \pause
  \item Algoritmos ``best-first search'', e.g., greedy best-first serach (GBFS), \astar.
\end{itemize}
\end{frame}

\subsection{Operadores Preferidos}
\begin{frame}{Operadores preferidos (PO)}
\begin{itemize}
\item \alert{Operadores} considerados \alert{promissores} ``por alguma razão''.
    \pause
  \begin{itemize}
  \item A definição não é fechada, mas tipicamente isso quer dizer ``operadores que levam a algum estado mais provável de satisfazer o gol''. % Helmert e eu.
  \end{itemize}
  \pause
\item Usados em conjunto com funções heurísticas.
  \begin{itemize}
  \item Sozinhos, são equivalentes a políticas (policies).
  \end{itemize}
\pause
\item No Fast Downward: usados em esquema ``\alert{dual-queue}''.
  \begin{itemize}
  \item Uma fila para todos os estados, outra para \alert{estados gerados exclusivamente via POs}.
  \item Expansão alternada, ou não (\alert{boosting}).
  \end{itemize}
\end{itemize}
\end{frame}

\begin{frame}{Operadores preferidos do FF}
\end{frame}

\subsection{Aprendendo Funções Heurísticas}
\begin{frame}{Aprendizado de funções heurísticas}
\end{frame}

\section{Abordagem proposta}
\begin{frame}{Como aprender operadores preferidos?}
\end{frame}

\subsection{Operadores Preferidos Ideais}
\begin{frame}{Operadores preferidos ideais}
\end{frame}

\subsection{Operadores Preferidos Descobertos}
\begin{frame}{Operadores preferidos descobertos}
\end{frame}

\subsection{Gerando Amostras com \bfsrs}
\begin{frame}{Gerando amostras com \bfsrs}
\end{frame}

\section{Experimentos}
\begin{frame}{Configuração}
\end{frame}

\subsection{Aprendendo Operadores Preferidos}
\begin{frame}{}
\end{frame}

%\subsection{Conjuntos de Amostras de Diferentes Tamanhos}
%\begin{frame}{}
%\end{frame}

\subsection{\bfsrs vs. \bfsrw}
\begin{frame}{}
\end{frame}

\subsection{Operadores Preferidos com Funções Heurísticas Lógicas}
\begin{frame}{}
\end{frame}


\section{Conclusão}
\begin{frame}{Conclusão}
\end{frame}

\printbibliography

\end{document}
